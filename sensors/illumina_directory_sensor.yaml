---
class_name: IlluminaDirectorySensor
entry_point: illumina_directory_sensor.py
description: >
  Sensor that emits triggers for seqencing run directories that are direct
  children of a specific directory, as well as any analysis directories that
  are found in those run directories.
poll_interval: 60
enabled: false
trigger_types:
  - name: state_change
    pack: gmc_norr_seqdata
    description: >
      Triggers when the state of a directory changes
    payload_schema:
      type: object
      properties:
        path:
          type: string
          description: The directory whose state has changed
        state:
          type: string
          description: The state of the directory
        directory_type:
          type: string
          description: The type of directory
          enum: [run, analysis]
        message:
          type: string
          description: A message associated with the state change

  - name: new_directory
    pack: gmc_norr_seqdata
    description: >
      Triggers when a new directory is found
    payload_schema:
      type: object
      properties:
        path:
          type: string
          description: The path to the new directory
        state:
          type: string
          description: The state of the directory
        directory_type:
          type: string
          description: The type of directory
          enum: [run, analysis]
        message:
          type: string
          description: A message associated with the state change

  - name: incomplete_directory
    pack: gmc_norr_seqdata
    description: >
      Triggers when a new directory is found, but it is somehow incomplete
      and thus cannot be added to the database.
    payload_schema:
      type: object
      properties:
        path:
          type: string
          description: The path to the directory
        state:
          type: string
          description: The state of the directory
          enum: [incomplete, error]
        directory_type:
          type: string
          description: The type of directory
          enum: [run, analysis]
        message:
          type: string
          description: A message describing why the directory is incomplete
